

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Deploying CloudFoundry with BOSH Director on OpenStack &mdash; Deploying Cloud Foundry on Private Cloud 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Install BOSH" href="BOSH.html" />
    <link rel="prev" title="4. Configure OpenStack" href="CFconfig.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Deploying Cloud Foundry on Private Cloud
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="MAAS.html">1. Install MAAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Juju.html">2. Install Juju</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenStack.html">3. Install OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFconfig.html">4. Configure OpenStack</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Deploying CloudFoundry with BOSH Director on OpenStack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">5.1. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cf-openstack-validator-installation">5.2. CF-OpenStack-Validator installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites-for-cf-openstack-validator">5.2.1. Prerequisites for CF-OpenStack-Validator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-of-cf-openstack-validator">5.2.2. Installation of CF-OpenStack-Validator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-configurations">5.2.3. Additional configurations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#validate-the-openstack-configuration">5.3. Validate the OpenStack configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prepare-openstack-environment-for-bosh-and-cloud-foundry-via-terraform">5.4. Prepare OpenStack environment for BOSH and Cloud Foundry via Terraform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#install-terraform-module">5.4.1. Install Terraform module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openstack-environment-for-bosh">5.4.2. OpenStack environment for BOSH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setup-an-openstack-project-to-install-bosh">Setup an OpenStack project to install BOSH:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#terraform-tempalte-file-configuration-for-bosh">Terraform tempalte file configuration for BOSH:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#openstack-environment-for-cloud-foundry">5.4.3. OpenStack environment for Cloud Foundry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setup-an-openstack-project-to-install-cloud-foundry">Setup an OpenStack project to install Cloud Foundry:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#terraform-tempalte-file-configuration-for-cloud-foundry">Terraform tempalte file configuration for Cloud Foundry:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#install-bosh">5.5. Install BOSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cloud-config">5.6. Cloud Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-cloud-foundry">5.7. Deploy Cloud Foundry</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BOSH.html">6. Install BOSH</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Deploying Cloud Foundry on Private Cloud</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>5. Deploying CloudFoundry with BOSH Director on OpenStack</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/CFdeployment.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deploying-cloudfoundry-with-bosh-director-on-openstack">
<span id="cf-deploy"></span><h1>5. Deploying CloudFoundry with BOSH Director on OpenStack<a class="headerlink" href="#deploying-cloudfoundry-with-bosh-director-on-openstack" title="Permalink to this headline">¶</a></h1>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p>Draft: to be deleted after the documentation is ready:</p>
<ol class="arabic simple">
<li>Configure OpenStack Domain,Project, User, Network for the deployment - Done in Section <a class="reference internal" href="CFconfig.html#cf-config"><span class="std std-ref">“4. Configure OpenStack”</span></a></li>
</ol>
<p>2. Validate the OpenStack configuration using:
<a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator">https://github.com/eniware-org/cf-openstack-validator</a> :</p>
<ul class="simple">
<li>cf-openstack-validator installation done in section <a class="reference internal" href="#cf-deploy-cfval-install"><span class="std std-ref">5.2. CF-OpenStack-Validator installation</span></a></li>
</ul>
<p>3. Setup the OpenStack projects for the BOSH and CloudFoundry installation using TerraForm modules from here:
<a class="reference external" href="https://github.com/eniware-org/bosh-openstack-environment-templates">https://github.com/eniware-org/bosh-openstack-environment-templates</a></p>
<p>4. Install BOSH:
<a class="reference external" href="https://bosh.io/docs/init-openstack/#deploy">https://bosh.io/docs/init-openstack/#deploy</a></p>
<ol class="last arabic simple" start="5">
<li>Prepare and upload <code class="docutils literal notranslate"><span class="pre">cloud-config.yml</span></code> to BOSH to finilize the cloud configuration.</li>
<li>Deploy CloudFoundry.</li>
</ol>
</div>
<p>In <a class="reference internal" href="CFconfig.html#cf-config"><span class="std std-ref">previous section</span></a> we’ve configured OpenStack for use within a production environment. Various types of <a class="reference internal" href="CFconfig.html#cf-clients-install"><span class="std std-ref">clients</span></a> were installed for different OpenStack operations. We have set <a class="reference internal" href="CFconfig.html#cf-env-conf"><span class="std std-ref">environment variables</span></a>, <a class="reference internal" href="CFconfig.html#cf-net-conf"><span class="std std-ref">external network</span></a>, <a class="reference internal" href="CFconfig.html#cf-domain-flavors"><span class="std std-ref">flavors</span></a>, <a class="reference internal" href="CFconfig.html#cf-domain-conf"><span class="std std-ref">domain, project and user</span></a>.</p>
<p>In this section we’ll create an environment that consists of a BOSH Director and Cloudfoudry deployment that it orchestrates.</p>
<div class="section" id="prerequisites">
<span id="cf-deploy-prereq"></span><h2>5.1. Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>To be able to proceed, you need to the following:</p>
<ul class="simple">
<li><a class="reference internal" href="OpenStack.html#install-openstack"><span class="std std-ref">Working OpenStack environment</span></a> using both Juju and MAAS.</li>
<li>A <a class="reference internal" href="CFconfig.html#cf-domain-conf"><span class="std std-ref">user</span></a> able to create/delete resource in this environment.</li>
<li><a class="reference internal" href="CFconfig.html#cf-domain-flavors"><span class="std std-ref">Flavors</span></a> with properly configured names and settings.</li>
</ul>
</div>
<div class="section" id="cf-openstack-validator-installation">
<span id="cf-deploy-cfval-install"></span><h2>5.2. CF-OpenStack-Validator installation<a class="headerlink" href="#cf-openstack-validator-installation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator/tree/master/extensions/object_storage">CF OpenStack Validator is an extension</a>  that verifies whether the OpenStack installation is ready to run BOSH and install Cloud Foundry. The intended place to run the validator is a VM within your OpenStack.</p>
<div class="section" id="prerequisites-for-cf-openstack-validator">
<span id="cf-deploy-cfval-pre"></span><h3>5.2.1. Prerequisites for CF-OpenStack-Validator<a class="headerlink" href="#prerequisites-for-cf-openstack-validator" title="Permalink to this headline">¶</a></h3>
<p>OpenStack configuration requirements are as follows:</p>
<ul class="simple">
<li><a class="reference internal" href="OpenStack.html#openstack-deploy"><span class="std std-ref">Keystone</span></a> v.2/v.3 Juju charm installed.</li>
<li>Created <a class="reference internal" href="CFconfig.html#cf-domain-conf"><span class="std std-ref">OpenStack project</span></a>.</li>
<li>Created <em>user</em> with access to the previously created <em>project</em> (ideally you don’t want to run as admin).</li>
<li>Created network - connect the network with a router to your external network.</li>
<li>Allocated a floating IP.</li>
<li>Allowed ssh access in the <em>default</em> security group - create a key pair by executing:</li>
</ul>
<blockquote>
<div><div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ ssh-keygen -t rsa -b 4096 -N &quot;&quot; -f cf-validator.rsa_id
</pre></div>
</div>
<p>Upload the generated public key to OpenStack as <strong>cf-validator</strong>.</p>
</div></blockquote>
<ul class="simple">
<li>A public <a class="reference internal" href="CFconfig.html#cf-cloud-conf"><span class="std std-ref">image</span></a> available in <strong>Glance</strong>.</li>
</ul>
<p>The validator runs on Linux. Please ensure that the following packages are installed on your system:</p>
<ul class="simple">
<li><a class="reference external" href="https://packages.ubuntu.com/bionic/ruby">ruby</a> 2.4.x or newer</li>
<li><a class="reference external" href="https://packages.ubuntu.com/bionic/make">make</a></li>
<li><a class="reference external" href="https://packages.ubuntu.com/bionic/gcc">gcc</a></li>
<li><a class="reference external" href="https://packages.ubuntu.com/bionic/zlib1g-dev">zlib1g-dev</a></li>
<li><a class="reference external" href="https://packages.ubuntu.com/bionic/libssl-dev">libssl-dev</a></li>
<li><a class="reference external" href="https://packages.ubuntu.com/bionic/ssh">ssh</a></li>
</ul>
</div>
<div class="section" id="installation-of-cf-openstack-validator">
<span id="cf-deploy-cfval-command"></span><h3>5.2.2. Installation of CF-OpenStack-Validator<a class="headerlink" href="#installation-of-cf-openstack-validator" title="Permalink to this headline">¶</a></h3>
<p>To clone the CF-OpenStack-Validator repository:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">eniware</span><span class="o">-</span><span class="n">org</span><span class="o">/</span><span class="n">cf</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">validator</span>
</pre></div>
</div>
<p>Navigate to the <strong>cf-openstack-validator</strong> folder:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">cf</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">validator</span>
</pre></div>
</div>
<p>Copy the <a class="reference internal" href="#cf-deploy-cfval-pre"><span class="std std-ref">generated private key</span></a> into the <strong>cf-openstack-validator</strong> folder.</p>
<p>Copy <code class="docutils literal notranslate"><span class="pre">validator.template.yml</span></code> to <code class="docutils literal notranslate"><span class="pre">validator.yml</span></code> and replace occurrences of <strong>&lt;replace-me&gt;</strong> with appropriate values (see <a class="reference internal" href="#cf-deploy-cfval-pre"><span class="std std-ref">prerequisites</span></a>):</p>
<blockquote>
<div><ul class="simple">
<li>If using Keystone v.3, ensure there are values for <em>domain</em> and <em>project</em>.</li>
<li>If using Keystone v.2, remove <em>domain</em> and <em>project</em>, and ensure there is a value for <em>tenant</em>. Also use the Keystone v.2 URL as <em>auth_url</em>.</li>
</ul>
</div></blockquote>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ cp validator.template.yml validator.yml
</pre></div>
</div>
<p>Download a <strong>stemcell</strong> from <a class="reference external" href="https://bosh.io/stemcells/bosh-openstack-kvm-ubuntu-trusty-go_agent">OpenStack stemcells bosh.io</a>:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget --content-disposition https://bosh.io/d/stemcells/bosh-openstack-kvm-ubuntu-trusty-go_agent
</pre></div>
</div>
<p>Install the following dependencies:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ gem install bundler
$ bundle install
</pre></div>
</div>
</div>
<div class="section" id="additional-configurations">
<span id="cf-deploy-cfval-conf"></span><h3>5.2.3. Additional configurations<a class="headerlink" href="#additional-configurations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>CPI:</strong></li>
</ul>
<blockquote>
<div><p>Validator downloads <strong>CPI</strong> release from the URL specified in the validator configuration. You can override this by specifying the <code class="docutils literal notranslate"><span class="pre">--cpi-release</span></code> command line option with the path to a CPI release tarball.</p>
<p>If you already have a CPI compiled, you can specify the path to the executable in the environment variable <code class="docutils literal notranslate"><span class="pre">OPENSTACK_CPI_BIN</span></code>. This is used when no CPI release is specified on the command line. It overrides the setting in the validator configuration file.</p>
</div></blockquote>
<ul class="simple">
<li><strong>Extensions:</strong></li>
</ul>
<blockquote>
<div><p>You can extend the validator with custom tests. For a detailed description and examples, please have a look at the <a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator/blob/master/docs/extensions.md">extension documentation</a>.</p>
<p>The <a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator/tree/master/extensions">eniware-org repository</a> already contains some extensions. Each extension has its own documentation which can be found in the corresponding extension folder.</p>
</div></blockquote>
<p>To learn about available cf-validator options run the following command:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./validate --help
</pre></div>
</div>
<p>You can find more additional OpenStack related configuration options for possible solutions <a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator/blob/master/docs/openstack_configurations.md">here</a>.</p>
</div>
</div>
<div class="section" id="validate-the-openstack-configuration">
<span id="cf-deploy-cfval"></span><h2>5.3. Validate the OpenStack configuration<a class="headerlink" href="#validate-the-openstack-configuration" title="Permalink to this headline">¶</a></h2>
<p>Before deploying Cloud Foundry, make sure to successfully run the <a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator">CF-OpenStack-Validator</a> against your project:</p>
<ul class="simple">
<li>Make sure you have the <a class="reference internal" href="CFconfig.html#flavours-required"><span class="std std-ref">required flavors</span></a> on OpenStack by enabling the <a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator/tree/master/extensions/flavors">flavors extension</a> with the <a class="reference external" href="https://github.com/eniware-org/cf-deployment/blob/master/iaas-support/openstack/flavors.yml">flavors.yml</a> file in this directory. Flavor names need to match those specified in the cloud config.</li>
<li>If you plan using the <a class="reference external" href="https://github.com/eniware-org/cf-deployment/blob/master/operations/use-swift-blobstore.yml">Swift ops file</a> to enable Swift as blobstore for the Cloud Controller, you should also run the <a class="reference external" href="https://github.com/eniware-org/cf-openstack-validator/tree/master/extensions/object_storage">Swift extension</a>.</li>
</ul>
<p>To <strong>start the validation process</strong> type the following command:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./validate --stemcell bosh-stemcell-&lt;xxx&gt;-openstack-kvm-ubuntu-trusty-go_agent.tgz --config validator.yml
</pre></div>
</div>
</div>
<div class="section" id="prepare-openstack-environment-for-bosh-and-cloud-foundry-via-terraform">
<span id="cf-deploy-terraform"></span><h2>5.4. Prepare OpenStack environment for BOSH and Cloud Foundry via Terraform<a class="headerlink" href="#prepare-openstack-environment-for-bosh-and-cloud-foundry-via-terraform" title="Permalink to this headline">¶</a></h2>
<p>You can use a <strong>Terraform environment template</strong> to configure your OpenStack project automatically. You will need to create a <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> file with information about the environment.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The terraform scripts will output the OpenStack resource information required for the BOSH manifest. Make sure to treat the created <code class="docutils literal notranslate"><span class="pre">terraform.tfstate</span></code> files with care.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Instead of using Terraform, you can prepare an OpenStack environment <strong>manually</strong> as described <a class="reference external" href="https://bosh.io/docs/init-openstack/#configuration-of-a-new-openstack-project">here</a>.</p>
</div>
<div class="section" id="install-terraform-module">
<span id="cf-deploy-terraform-inst"></span><h3>5.4.1. Install Terraform module<a class="headerlink" href="#install-terraform-module" title="Permalink to this headline">¶</a></h3>
<p>Make sure you have updated package database and installed unzip package:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">git</span> <span class="n">unzip</span>
</pre></div>
</div>
<p>To install the <strong>Terraform</strong> module:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">eniware</span><span class="o">-</span><span class="n">org</span><span class="o">/</span><span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">.</span><span class="n">git</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">releases</span><span class="o">.</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">terraform</span><span class="o">/</span><span class="mf">0.11</span><span class="o">.</span><span class="mi">11</span><span class="o">/</span><span class="n">terraform_0</span><span class="o">.</span><span class="mf">11.11</span><span class="n">_linux_amd64</span><span class="o">.</span><span class="n">zip</span>
<span class="n">unzip</span> <span class="n">terraform_0</span><span class="o">.</span><span class="mf">11.11</span><span class="n">_linux_amd64</span><span class="o">.</span><span class="n">zip</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">terraform</span>
<span class="n">sudo</span> <span class="n">mv</span> <span class="n">terraform</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="openstack-environment-for-bosh">
<span id="cf-deploy-bosh-env"></span><h3>5.4.2. OpenStack environment for BOSH<a class="headerlink" href="#openstack-environment-for-bosh" title="Permalink to this headline">¶</a></h3>
<div class="section" id="setup-an-openstack-project-to-install-bosh">
<span id="cf-deploy-bosh-env-set"></span><h4>Setup an OpenStack project to install BOSH:<a class="headerlink" href="#setup-an-openstack-project-to-install-bosh" title="Permalink to this headline">¶</a></h4>
<p>To setup an OpenStack project to install BOSH please use the following <a class="reference external" href="https://github.com/eniware-org/bosh-openstack-environment-templates/tree/master/bosh-init-tf">Terraform module</a>. Adapt <code class="docutils literal notranslate"><span class="pre">terraform.tfvars.template</span></code> to your needs.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Create a working folder:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">tmp</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Copy the <a class="reference internal" href="#terraform-tfvars-bosh"><span class="std std-ref">template file</span></a>:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">bosh</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">tf</span><span class="o">/</span><span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span><span class="o">.</span><span class="n">template</span> <span class="n">tmp</span><span class="o">/</span><span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Generate a key pair executing the following script:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">bosh</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">cf</span><span class="o">/</span><span class="n">generate_ssh_keypair</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Move the generated key pair to your working folder <code class="docutils literal notranslate"><span class="pre">tmp</span></code>:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mv</span> <span class="n">bosh</span><span class="o">.*</span> <span class="n">tmp</span><span class="o">/</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li>Navigate to the working folder <code class="docutils literal notranslate"><span class="pre">tmp</span></code>:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">tmp</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li>Configure the <a class="reference internal" href="#terraform-tfvars-bosh"><span class="std std-ref">Terraform environment template</span></a> <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code>.</li>
<li>Run the following commands:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">terraform</span> <span class="n">init</span> <span class="o">../</span><span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">bosh</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">tf</span><span class="o">/</span>
<span class="n">terraform</span> <span class="n">apply</span> <span class="o">../</span><span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">bosh</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">tf</span><span class="o">/</span>
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li>Save the <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> and <code class="docutils literal notranslate"><span class="pre">terraform.tfstate</span></code> files for <strong>bosh-init-tf</strong>:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mv</span> <span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span> <span class="n">bosh_terraform</span><span class="o">.</span><span class="n">tfvars</span>
<span class="n">mv</span> <span class="n">terraform</span><span class="o">.</span><span class="n">tfstate</span> <span class="n">bosh_terraform</span><span class="o">.</span><span class="n">tfstate</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="terraform-tempalte-file-configuration-for-bosh">
<span id="terraform-tfvars-bosh"></span><h4>Terraform tempalte file configuration for BOSH:<a class="headerlink" href="#terraform-tempalte-file-configuration-for-bosh" title="Permalink to this headline">¶</a></h4>
<p>The content of the <a class="reference external" href="https://github.com/eniware-org/bosh-openstack-environment-templates/blob/master/bosh-init-tf/terraform.tfvars.template">terraform tempalte file</a> <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> for BOSH is as follows:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auth_url</span> <span class="o">=</span> <span class="s2">&quot;&lt;auth_url&gt;&quot;</span>
<span class="n">domain_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;domain_name&gt;&quot;</span>
<span class="n">user_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;ostack_user&gt;&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;&lt;ostack_pw&gt;&quot;</span>
<span class="n">tenant_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;ostack_tenant_name&gt;&quot;</span>
<span class="n">region_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;region_name&gt;&quot;</span>
<span class="n">availability_zone</span> <span class="o">=</span> <span class="s2">&quot;&lt;availability_zone&gt;&quot;</span>

<span class="n">ext_net_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;ext_net_name&gt;&quot;</span>
<span class="n">ext_net_id</span> <span class="o">=</span> <span class="s2">&quot;&lt;ext_net_id&gt;&quot;</span>

<span class="c1"># in case your OpenStack needs custom nameservers</span>
<span class="c1"># dns_nameservers = 8.8.8.8</span>

<span class="c1"># Disambiguate keypairs with this suffix</span>
<span class="c1"># keypair_suffix = &quot;&lt;keypair_suffix&gt;&quot;</span>

<span class="c1"># Disambiguate security groups with this suffix</span>
<span class="c1"># security_group_suffix = &quot;&lt;security_group_suffix&gt;&quot;</span>

<span class="c1"># in case of self signed certificate select one of the following options</span>
<span class="c1"># cacert_file = &quot;&lt;path-to-certificate&gt;&quot;</span>
<span class="c1"># insecure = &quot;true&quot;</span>
</pre></div>
</div>
<p>To edit the <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> for BOSH using the described in this documentation scenario:</p>
<div class="code highlight-default notranslate" id="terraform-tfvars-bosh-example"><div class="highlight"><pre><span></span><span class="n">nano</span> <span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span>
</pre></div>
</div>
<p>Enter the following settings:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auth_url</span><span class="o">=</span><span class="s2">&quot;http://192.168.40.228:5000/v3&quot;</span>
<span class="n">domain_name</span><span class="o">=</span><span class="s2">&quot;cf_domain&quot;</span>
<span class="n">user_name</span><span class="o">=</span><span class="s2">&quot;eniware&quot;</span>
<span class="n">password</span><span class="o">=</span> <span class="o">&lt;</span><span class="n">your_password</span><span class="o">&gt;</span>
<span class="n">tenant_name</span><span class="o">=</span><span class="s2">&quot;cloudfoundry&quot;</span>
<span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;RegionOne&quot;</span>
<span class="n">availability_zone</span><span class="o">=</span><span class="s2">&quot;nova&quot;</span>
<span class="n">ext_net_name</span><span class="o">=</span><span class="s2">&quot;ext_net&quot;</span>
<span class="n">ext_net_id</span><span class="o">=</span><span class="s2">&quot;db178716-7d8a-444b-854a-685feb5bf7ea&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">auth_url</span></code> is the <a class="reference internal" href="OpenStack.html#openstack-test"><span class="std std-ref">URL of the Keystone service</span></a>, which is <code class="docutils literal notranslate"><span class="pre">http://192.168.40.228:5000/v3</span></code> in our case (it can be retrieved by using <code class="docutils literal notranslate"><span class="pre">juju</span> <span class="pre">status</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">keystone/0</span></code> command).</li>
<li>The <a class="reference internal" href="CFconfig.html#cf-domain-conf"><span class="std std-ref">created</span></a> <em>domain</em> <strong>cf_domain</strong>, with <em>project</em> <strong>cloudfondry</strong> and <em>user</em> <strong>eniware</strong> are set in the template in the <code class="docutils literal notranslate"><span class="pre">domain_name</span></code>, <code class="docutils literal notranslate"><span class="pre">user_name</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>, and <code class="docutils literal notranslate"><span class="pre">tenant_name</span></code> fields.</li>
<li><code class="docutils literal notranslate"><span class="pre">region_name</span></code> can be retrieved when editing the Neutron config file or from <a class="reference internal" href="CFconfig.html#neutron-region"><span class="std std-ref">here</span></a>.</li>
<li>The <a class="reference internal" href="CFconfig.html#cf-net-conf"><span class="std std-ref">defined external network</span></a> is set in <code class="docutils literal notranslate"><span class="pre">ext_net_name</span></code> filed.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">ext_name_id</span></code> identificator can be retrieved from the OpenStack web UI (go to <em>Project &gt; Network &gt; Networks</em>, click on <strong>ext_net</strong> and go to <strong>Overview</strong> tab) or by using the <a class="reference internal" href="CFconfig.html#ext-net-id"><span class="std std-ref">command</span></a> <code class="docutils literal notranslate"><span class="pre">openstack</span> <span class="pre">network</span> <span class="pre">list</span></code>.</li>
</ul>
</div>
</div>
<div class="section" id="openstack-environment-for-cloud-foundry">
<span id="cf-deploy-cf-env"></span><h3>5.4.3. OpenStack environment for Cloud Foundry<a class="headerlink" href="#openstack-environment-for-cloud-foundry" title="Permalink to this headline">¶</a></h3>
<div class="section" id="setup-an-openstack-project-to-install-cloud-foundry">
<span id="cf-deploy-cf-env-set"></span><h4>Setup an OpenStack project to install Cloud Foundry:<a class="headerlink" href="#setup-an-openstack-project-to-install-cloud-foundry" title="Permalink to this headline">¶</a></h4>
<p>To setup the project to install Cloud Foundry please use the following <a class="reference external" href="https://github.com/eniware-org/bosh-openstack-environment-templates/tree/master/cf-deployment-tf">Terraform module</a>. Adapt <code class="docutils literal notranslate"><span class="pre">terraform.tfvars.template</span></code> to your needs. Variable <code class="docutils literal notranslate"><span class="pre">bosh_router_id</span></code> is output of the previous BOSH terraform module.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Copy the <a class="reference internal" href="#terraform-tfvars-cf"><span class="std std-ref">template file</span></a> <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> file for <strong>cf-deployment-tf</strong>:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">../</span><span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">-</span><span class="n">tf</span><span class="o">/</span><span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span><span class="o">.</span><span class="n">template</span> <span class="o">./</span><span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Configure the <a class="reference internal" href="#terraform-tfvars-cf"><span class="std std-ref">Terraform environment template</span></a> <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> for <strong>cf-deployment-tf</strong>:</li>
<li>Run the following commands:</li>
</ol>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">terraform</span> <span class="n">init</span> <span class="o">../</span><span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">-</span><span class="n">tf</span><span class="o">/</span>
<span class="n">terraform</span> <span class="n">apply</span> <span class="o">../</span><span class="n">bosh</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">environment</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">-</span><span class="n">tf</span><span class="o">/</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="terraform-tempalte-file-configuration-for-cloud-foundry">
<span id="terraform-tfvars-cf"></span><h4>Terraform tempalte file configuration for Cloud Foundry:<a class="headerlink" href="#terraform-tempalte-file-configuration-for-cloud-foundry" title="Permalink to this headline">¶</a></h4>
<p>The content of the <a class="reference external" href="https://github.com/eniware-org/bosh-openstack-environment-templates/blob/master/cf-deployment-tf/terraform.tfvars.template">terraform tempalte file</a> <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> for Cloud Foundry is as follows:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auth_url</span> <span class="o">=</span> <span class="s2">&quot;&lt;auth-url&gt;&quot;</span>
<span class="n">domain_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;domain&gt;&quot;</span>
<span class="n">user_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;user&gt;&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;&lt;password&gt;&quot;</span>
<span class="n">project_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;project-name&gt;&quot;</span>
<span class="n">region_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;region-name&gt;&quot;</span>
<span class="n">availability_zones</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;az-1&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;az-2&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;az-3&gt;&quot;</span><span class="p">]</span>
<span class="n">ext_net_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;external-network-name&gt;&quot;</span>

<span class="c1"># the OpenStack router id which can be used to access the BOSH network</span>
<span class="n">bosh_router_id</span> <span class="o">=</span> <span class="s2">&quot;&lt;bosh-router-id&gt;&quot;</span>

<span class="c1"># in case Openstack has its own DNS servers</span>
<span class="n">dns_nameservers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;dns-server-1&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;dns-server-2&gt;&quot;</span><span class="p">]</span>

<span class="c1"># does BOSH use a local blobstore? Set to &#39;false&#39;, if your BOSH Director uses e.g. S3 to store its blobs</span>
<span class="n">use_local_blobstore</span> <span class="o">=</span> <span class="s2">&quot;&lt;true or false&gt;&quot;</span> <span class="c1">#default is true</span>

<span class="c1"># enable TCP routing setup</span>
<span class="n">use_tcp_router</span> <span class="o">=</span> <span class="s2">&quot;&lt;true or false&gt;&quot;</span> <span class="c1">#default is true</span>
<span class="n">num_tcp_ports</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="c1">#default is 100, needs to be &gt; 0</span>

<span class="c1"># in case of self signed certificate select one of the following options</span>
<span class="c1"># cacert_file = &quot;&lt;path-to-certificate&gt;&quot;</span>
<span class="c1"># insecure = &quot;true&quot;</span>
</pre></div>
</div>
<p>To edit the <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> for Cloud Foundry using the described in this documentation scenario:</p>
<div class="code highlight-default notranslate" id="terraform-tfvars-cf-example"><div class="highlight"><pre><span></span><span class="n">nano</span> <span class="n">terraform</span><span class="o">.</span><span class="n">tfvars</span>
</pre></div>
</div>
<p>Enter the following settings:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auth_url</span><span class="o">=</span><span class="s2">&quot;http://192.168.40.228:5000/v3&quot;</span>
<span class="n">domain_name</span><span class="o">=</span><span class="s2">&quot;cf_domain&quot;</span>
<span class="n">user_name</span><span class="o">=</span><span class="s2">&quot;eniware&quot;</span>
<span class="n">password</span><span class="o">=</span> <span class="o">&lt;</span><span class="n">your_password</span><span class="o">&gt;</span>
<span class="n">tenant_name</span><span class="o">=</span><span class="s2">&quot;cloudfoundry&quot;</span>
<span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;RegionOne&quot;</span>
<span class="n">availability_zones</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nova&quot;</span><span class="p">,</span> <span class="s2">&quot;nova&quot;</span><span class="p">,</span> <span class="s2">&quot;nova&quot;</span><span class="p">]</span>
<span class="n">bosh_router_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">dns_nameservers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;8.8.8.8&quot;</span><span class="p">]</span>
<span class="n">use_local_blobstore</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
<span class="n">use_tcp_router</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
<span class="n">num_tcp_ports</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">auth_url</span></code>, <code class="docutils literal notranslate"><span class="pre">domain_name</span></code>, <code class="docutils literal notranslate"><span class="pre">user_name</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>, <code class="docutils literal notranslate"><span class="pre">tenant_name</span></code>, and <code class="docutils literal notranslate"><span class="pre">region_name</span></code> are the same as in <code class="docutils literal notranslate"><span class="pre">terraform.tfvars</span></code> <a class="reference internal" href="#terraform-tfvars-bosh-example"><span class="std std-ref">template file for BOSH</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">bosh_router_id</span></code> can be retrieved from the output of the previous <a class="reference internal" href="#terraform-tfvars-bosh-example"><span class="std std-ref">terraform script</span></a> for BOSH.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="install-bosh">
<span id="cf-deploy-bosh"></span><h2>5.5. Install BOSH<a class="headerlink" href="#install-bosh" title="Permalink to this headline">¶</a></h2>
<p>To install the BOSH director please follow the instructions on section <a class="reference internal" href="BOSH.html#install-bosh"><span class="std std-ref">6. Isntall BOSH</span></a> of this documentation.</p>
<p>For additional information you can visit <a class="reference external" href="https://bosh.io/docs/init-openstack/#deploy">bosh.io</a>.</p>
<p>Make sure the BOSH director is accessible through the BOSH cli, by following the instructions on <a class="reference external" href="https://bosh.io/docs/cli-envs.html">bosh.io</a>. Use this mechanism in all BOSH cli examples in this documentation.</p>
</div>
<div class="section" id="cloud-config">
<span id="cf-deploy-cloudconf"></span><h2>5.6. Cloud Config<a class="headerlink" href="#cloud-config" title="Permalink to this headline">¶</a></h2>
<p>After the BOSH director has been installed, you can prepare and upload a cloud config based on the <a class="reference external" href="https://github.com/eniware-org/cf-deployment/blob/master/iaas-support/openstack/cloud-config.yml">cloud-config.yml</a> file.</p>
<p>Take the variables and outputs from the Terraform run of <code class="docutils literal notranslate"><span class="pre">cf-deployment-tf</span></code> to finalize the cloud config.</p>
<p>Use the following command to upload the cloud config.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bosh</span> <span class="n">update</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="n">config</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">availability_zone1</span><span class="o">=</span><span class="s2">&quot;&lt;az-1&gt;&quot;</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">availability_zone2</span><span class="o">=</span><span class="s2">&quot;&lt;az-2&gt;&quot;</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">availability_zone3</span><span class="o">=</span><span class="s2">&quot;&lt;az-3&gt;&quot;</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">network_id1</span><span class="o">=</span><span class="s2">&quot;&lt;cf-network-id-1&gt;&quot;</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">network_id2</span><span class="o">=</span><span class="s2">&quot;&lt;cf-network-id-2&gt;&quot;</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">network_id3</span><span class="o">=</span><span class="s2">&quot;&lt;cf-network-id-3&gt;&quot;</span> \
     <span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">/</span><span class="n">iaas</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">openstack</span><span class="o">/</span><span class="n">cloud</span><span class="o">-</span><span class="n">config</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
</div>
<div class="section" id="deploy-cloud-foundry">
<span id="cf-deploy-cf"></span><h2>5.7. Deploy Cloud Foundry<a class="headerlink" href="#deploy-cloud-foundry" title="Permalink to this headline">¶</a></h2>
<p>To deploy Cloud Foundry run the following command filling in the necessary variables. system_domain is the user facing domain name of your Cloud Foundry installation.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bosh</span> <span class="o">-</span><span class="n">d</span> <span class="n">cf</span> <span class="n">deploy</span> <span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">/</span><span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">.</span><span class="n">yml</span> \
     <span class="o">-</span><span class="n">o</span> <span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">use</span><span class="o">-</span><span class="n">compiled</span><span class="o">-</span><span class="n">releases</span><span class="o">.</span><span class="n">yml</span> \
     <span class="o">-</span><span class="n">o</span> <span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">openstack</span><span class="o">.</span><span class="n">yml</span> \
     <span class="o">-</span><span class="n">v</span> <span class="n">system_domain</span><span class="o">=</span><span class="s2">&quot;&lt;system-domain&gt;&quot;</span>
</pre></div>
</div>
<p><strong>With Swift as Blobstore</strong></p>
<ul class="simple">
<li>Create four containers in Swift, which are used to store the artifacts for buildpacks, app-packages, droplets, and additional resources, respectively. The container names need to be passed in as variables in the below command snippet</li>
<li>Set a <a class="reference external" href="https://docs.openstack.org/swift/latest/api/temporary_url_middleware.html#secret-keys">Temporary URL Key</a> for your Swift account</li>
</ul>
<p>Add the following lines to the deploy cmd:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">o</span> <span class="n">cf</span><span class="o">-</span><span class="n">deployment</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">use</span><span class="o">-</span><span class="n">swift</span><span class="o">-</span><span class="n">blobstore</span><span class="o">.</span><span class="n">yml</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">auth_url</span><span class="o">=</span><span class="s2">&quot;&lt;auth-url&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">openstack_project</span><span class="o">=</span><span class="s2">&quot;&lt;project-name&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">openstack_domain</span><span class="o">=</span><span class="s2">&quot;&lt;domain&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">openstack_username</span><span class="o">=</span><span class="s2">&quot;&lt;user&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">openstack_password</span><span class="o">=</span><span class="s2">&quot;&lt;password&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">openstack_temp_url_key</span><span class="o">=</span><span class="s2">&quot;&lt;temp-url-key&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">app_package_directory_key</span><span class="o">=</span><span class="s2">&quot;&lt;app-package-directory-key&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">buildpack_directory_key</span><span class="o">=</span><span class="s2">&quot;&lt;buildpack-directory-key&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">droplet_directory_key</span><span class="o">=</span><span class="s2">&quot;&lt;droplet-directory-key&gt;&quot;</span> \
<span class="o">-</span><span class="n">v</span> <span class="n">resource_directory_key</span><span class="o">=</span><span class="s2">&quot;&lt;resource-directory-key&gt;&quot;</span> \
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="BOSH.html" class="btn btn-neutral float-right" title="6. Install BOSH" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="CFconfig.html" class="btn btn-neutral" title="4. Configure OpenStack" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, EniWARE.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>